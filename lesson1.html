<html>
<!-- based on openGL tutorial here: https://learnopengl.com/#!Getting-started/Hello-Window -->
<!-- based on webGL tutorial here: http://learningwebgl.com/blog/?p=28 -->
<!-- based on quick reference card here: https://www.khronos.org/files/webgl/webgl-reference-card-1_0.pdf -->
<script type="text/javascript">

    var gl;
    function initGL(canvas) {
        try {
            gl = canvas.getContext("experimental-webgl");
            gl.viewportWidth = canvas.width;
            gl.viewportHeight = canvas.height;
        } catch (e) {
        }
        if (!gl) {
            alert("Could not initialise WebGL, sorry :(");
        }
    }

    var keepGoing = true;
    var ticker;
    function webGLStart() {
        var canvas = document.getElementById("lesson01-canvas");
        initGL(canvas);

        // setup the input handling functions
        document.onkeydown = handleKeyDown;
        document.onkeyup = handleKeyUp;

        // setup system tick
        ticker = setInterval(tick, 20);
       
    }

    function tick(){
        handleInput();
        if ( keepGoing == false )
        {
            alert("Done");
            clearTimeout(ticker);
        }

        // clear the background by 
        // setting the color (state-setting)
        // clearing the buffer (state-using)
        gl.clearColor(0.2,0.3,0.3,1.0); // R G B A
        gl.clear(gl.COLOR_BUFFER_BIT);

    }

    var currentlyPressedKeys = {};
    function handleKeyDown(event) {
        currentlyPressedKeys[event.keyCode] = true;
    }

    function handleKeyUp(event) {
        currentlyPressedKeys[event.keyCode] = false;
    }

    function handleInput() {
        if ( currentlyPressedKeys[27] == true) // escape key 
        {
            keepGoing = false
        }
    }

</script>


<body onload="webGLStart();">
  <canvas id="lesson01-canvas" style="border: none;" width="500" height="500"></canvas>
</body>
</html>